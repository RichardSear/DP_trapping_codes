## Figure codes for diffusiophoretic trapping manuscript

Working repository for codes to produce figures for a forthcoming
manuscript (MS) on diffusiophoretic (DP) trapping of colloids and
macromolecules (eg DNA) by injected salt solutions.

Some codes simply plot flow fields or drift fields, others analyse
Brownian dynamics simulation data generated by an adaptive time step
Brownian dynamics (BD) code implemented in the sister project  
https://github.com/patrickbwarren/python3-adaptive-BD

Main text figures:
* Fig 1: Schematic of pipette flow field and salt concentration;
* Fig 2: Pipette drift field and fixed points for two Q values;
* Fig 3: Pipette BD results and action integral;
* Fig 4: Sampson flow and drift field for wall pore case;
* Fig 5: BD data for wall pore case.

Supplemental Material figures:
* Fig S1: Wall pore case, behaviour of fixed points;
* Fig S2: Individual endpoints for trajectories, pipette problem;
* Fig S3a: Pipette case, BD results varying cut off;
* Fig S3b: Wall pore case, BD results varying cut off;
* Fig S4: Wall pore case, BD results varying number of max steps;
* Fig S5ab: Pipette case, full BD results and action integral;
* Fig S5cd: Wall pore case, full BD results and action integral.

To make the figures, do something like
```
make DEST_DIR=..
```
where the destination directory is where the figure files end up, here
in the next level up.

All figures except Fig S2 are produced as PDF files.  Because of the
large number of data points, Fig S2 is produced as a PNG image at 300
dpi resolution by default.

Additional codes are:

* `raw_analyse.py`: extract RMSD data to spreadsheet from raw BD data;
* `describe.py`: applied to raw BD data, list column values / ranges;
* `models.py`: taken from BD code repository, implements models (drift field etc).

Some additional codes and datasets are included for future work.

#### Brownian dynamics datasets

Pipette studies:
* `data/vardp10k.dat.gz`: vary D<sub>p</sub> , max steps 10k;
* `data/vardp100k.dat.gz`: vary D<sub>p</sub> , max steps 100k;
* `data/varrc100k.dat.gz`: vary cut off r<sub>c</sub> .

Wall pore studies:
* `data/poredp10k.dat.gz`: vary D<sub>p</sub> , max steps 10k;
* `data/poredp100k.dat.gz`: vary D<sub>p</sub> , max steps 100k;
* `data/porerc10k.dat.gz`: vary cut off r<sub>c</sub> ;
* `data/poremsteps.dat.gz`: vary max steps.

Use `describe.py` to examine any of these, for example with
```
./describe.py data/vardp100k.dat.gz 
```
the result is
```
Dataset data/vardp100k.dat.gz contains 213500 records
  column                                    range      count
       k                                    200.0          1
       Γ                                    150.0          1
      Ds                                   1610.0          1
      Dp   1.0, 2.0, 5.0, 10.0, 20.0, 50.0, 100.0          7
      R1                                      1.0          1
       α                                      0.3          1
       Q                            0.0001--100.0         61
      rc                                      1.0          1
 t_final                                   3600.0          1
  ntrial                               53--100000      14836
nsuccess                                53--87849      21327
       t                          82.5364--3600.0      46515
Δt_final                   6.072946e-06--719.9856     165399
     Δr2                  0.000170023--20387500.0     212525
    traj                                    0--49         50
   block                                     0--9         10
   ntraj                                       50          1
  nblock                                       10          1
    code                                vardp100k          1
```

and for
```
./describe.py data/poremsteps.dat.gz 
```
the result is
```
Dataset data/poremsteps.dat.gz contains 91500 records
  column                       range      count
       k                       200.0          1
       Γ                       150.0          1
      Ds                      1610.0          1
      Dp                        10.0          1
      R1                         1.0          1
       Q               0.0001--100.0         61
      rc                         1.0          1
 t_final                      3600.0          1
  ntrial                 53--1000000      19401
nsuccess                  53--850368      25342
       t             4.58408--3600.0      28411
Δt_final      8.934066e-07--719.8398      75636
     Δr2     0.0003113814--1754635.0      91333
    traj                       0--49         50
   block                        0--9         10
   ntraj                          50          1
  nblock                          10          1
    code   pore10k, pore100k, pore1M          3
```

These datasets comprise compressed (gzip) tab-separated values, with
each row being the result of an individual BD trajectory.  Examples of
how to read and process them are in `raw_analyse.py` for example.

### Contacts

Richard P. Sear  
email: r.sear{at}surrey.ac.uk  
https://richardsear.me/  
School of Mathematics and Physics, University of Surrey, Guildford, GU2 7XH, United Kingdom

Patrick B. Warren  
email: patrick.warren{at}stfc.ac.uk  
https://sites.google.com/site/patrickbwarren/  
STFC Hartree Centre, Sci-Tech Daresbury, Warrington, WA4 4AD, United Kingdom

